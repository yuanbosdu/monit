<!DOCTYPE html>
{% load static %}
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1, maximum-scale=2, user-scalable=no" name="viewport" />
    <meta content="360monit 云监测平台" name="description" />
    <meta content="360monit 云监测平台" name="keywords" />
    <meta content="PPType" name="author" />
    <meta content="#ffffff" name="theme-color" />
    <title>360monit 云监测平台</title>
    <link href="{% static 'dist/semantic-ui/semantic.min.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'stylesheets/default.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'stylesheets/pandoc-code-highlight.css' %}" rel="stylesheet" type="text/css" />
    {# <script src="{% static 'dist/jquery/jquery.min.js' %}"></script> #}
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <!--[if IE]>
    <script type="text/javascript" src="path/to/flashcanvas.js"></script>
    <![endif]-->
    <script type="text/javascript" src="{% static 'dist/echarts/echarts.min.js' %}"></script>
    <style>
      #container {
        width : 600px;
        height: 400px;
        margin: 8px auto;
      }
    </style>
  </head>
  <body><div class="ui borderless fixed blue inverted pointing menu">
  <div class="ui container">
    <a class="header active item" href="blog.html#">Home</a><a class="item" href="blog.html#">New feature</a><a class="item" href="blog.html#">Press</a><a class="item" href="blog.html#">New hires</a><a class="item" href="blog.html#">About</a>
  </div>
</div>
<div class="ui grid container">
  <div class="row" id="page-header">
    <div class="ui basic segment">
      <h1 class="ui sub header">
        360Monit
      </h1>
      <span>高效、全面、智能监测云平台</span>
    </div>
  </div>
  <div class="row" id="article">
    <div class="sixteen wide column">
      <h2 class="ui sub header">
        烟雾报警器
      </h2>
      <div class="ui divider"></div>
      <p>
    {% for g, s in gas_state %}
      {% if forloop.first %}
      当前状态为：{{ s }}, 采集时间为：{{ g }}
      {% if s == 'Alarm!' %}
      <button class="ui red button">报警</button>
      {% endif %}
      {% endif %}
    {% endfor %}
      </p>
      <div id="container"></div>
      <div class="ui hidden divider"></div>
      <h2 class="ui sub header">
        温湿度传感器
      </h2>
      <div class="ui divider"></div>
      <p>
        Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Sed posuere consectetur est at lobortis. Cras mattis consectetur purus sit amet fermentum.
      </p>
      <div class="ui hidden divider"></div>
      <h2 class="ui sub header">我的台灯</h2>
      <div class="ui divider"></div>
      <div class="ui toggle checkbox">
        <input type="checkbox" name="gasAction" id="gasAction">
        <label>ON</label>
      </div>
    </div>
  </div>
</div>
<div class="ui footer secondary segment">
  <div class="ui center aligned container">
    <p>
      Blog template built for Semantic-UI by <a href="https://github.com/semantic-ui-forest">@Semantic-UI-Forest</a>.
    </p>
    <a href="#">Back to top</a>
  </div>
</div>
<style type="text/css">
  body {
    font-family: Georgia, "Times New Roman", "Times", serif;
  }
  
  .ui.inverted.pointing.menu .active.item:after {
    background-color: white !important;
  }
  
  .ui.sub.header {
    text-transform: none;
  }
  
  #page-header {
    margin-top: 4em;
  }
  #page-header h1 {
    font-size: 60px;
  }
  #page-header span {
    font-size: 20px;
    color: grey;
  }
  
  #article {
    font-size: 18px;
    line-height: 1.3;
  }
  #article h2 {
    font-size: 40px;
  }
  #article span {
    color: grey;
  }
  #article .four.wide.column .ui.secondary.segment {
    border: none;
  }
  #article .four.wide.column .ui.list .item {
    font-size: 14px;
  }
  
  .ui.footer.segment {
    margin-bottom: 0;
  }
</style>
  <script type="text/javascript">
      (function () {
        var myChart = echarts.init(document.getElementById('container'));




        $.get('http://localhost:8000/index/api/device/?english=Gas', function(data, status) {

          var xdata = [];
          var xvalue = [];
          var i;
          for (i=0; i<data.length; i++) {
            xdata.push(data[i][0]);
            if (data[i][1] == 'Alarm!')
              xvalue.push(1);
            else
              xvalue.push(0);
          }

          var option = {
          title: {
            left: 'center',
            text: '烟雾状态曲线',
          },
          toolbox: {
            feature: {
              dataZoom: {
                  yAxisIndex: 'none'
              },
              restore: {},
              saveAsImage: {}
            }
          },
          legend: {
            data: ['烟雾状态'],
          },
          xAxis: {
            type: 'category',
            data: xdata,
          },
          yAxis: {
            type: 'value',
            boundaryGap: [0, '100%']
          },
          series: [{
            name: '状态',
            type: 'line',
            data: xvalue,
          }],
          };

          myChart.setOption(option);
          });



      })();


        // Sample the sine function
        //for (i = 0; i < 4 * Math.PI; i += 0.2) {
        //  data.push([i, Math.sin(i)]);
        //}

        //for (i = 0; i<100; i++) {
        //  gdata.push([i, i%2]);
        //  }

        $("input[name='gasAction']").bind('change', function() {
          var state = $(this)[0].checked;
          console.log(state);
          if (state == true) {
            console.log("checked");
            $.post('http://localhost:8000/serial/change/',
              {
                'english': 'taideng',
                'action': 'change',
                'newstate': 'ON',
              },
              function(data) {
                console.log(data);
              });
            }
          else {
            console.log("un checked");
            $.post('http://localhost:8000/serial/change/',
            {
              'english': 'taideng',
              'action': 'change',
              'newstate': 'OFF',
            },
            function(data) {
              console.log(data);
            });
            }
        });


    </script>
  </body>
</html>
